<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Api · ReplicateBE</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>ReplicateBE</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../examples/">Examples</a></li><li><a class="toctext" href="../syntax/">Syntax</a></li><li><a class="toctext" href="../details/">Details</a></li><li><a class="toctext" href="../testval/">Validation</a></li><li><a class="toctext" href="../struct/">Structures</a></li><li class="current"><a class="toctext" href>Api</a><ul class="internal"><li><a class="toctext" href="#API-1">API</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Api</a></li></ul><a class="edit-page" href="https://github.com/PharmCat/ReplicateBE.jl/blob/master/docs/src/api.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Api</span><a class="fa fa-bars" href="#"></a></div></header><h2><a class="nav-anchor" id="API-1" href="#API-1">API</a></h2><h3><a class="nav-anchor" id="ReplicateBE.RBE-1" href="#ReplicateBE.RBE-1">ReplicateBE.RBE</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ReplicateBE.RBE" href="#ReplicateBE.RBE"><code>ReplicateBE.RBE</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">    struct RBE
        model::ModelFrame               #Model frame
        rmodel::ModelFrame              #Random effect model
        design::Design                  #Design description
        factors::Array{Symbol, 1}       #Factor list
        θ0::Array{Float64, 1}           #Initial variance paramethers
        θ::Tuple{Vararg{Float64}}       #Final variance paramethers
        reml::Float64                   #-2REML
        fixed::EffectTable              #Fixed Effect table
        typeiii::ContrastTable          #Type III table
        R::Array{Matrix{Float64},1}     #R matrices for each subject
        V::Array{Matrix{Float64},1}     #V matrices for each subject
        G::Matrix{Float64}              #G matrix
        C::Matrix{Float64}              #C var(β) p×p variance-covariance matrix
        A::Matrix{Float64}              #asymptotic variance-covariance matrix of b θ
        H::Matrix{Float64}              #Hessian matrix
        X::Matrix                       #Matrix for fixed effects
        Z::Matrix                       #Matrix for random effects
        Xv::Array{Matrix{Float64},1}    #X matrices for each subject
        Zv::Array{Matrix{Float64},1}    #Z matrices for each subject
        yv::Array{Array{Float64, 1},1}  #responce vectors for each subject
        detH::Float64                   #Hessian determinant
        preoptim::Union{Optim.MultivariateOptimizationResults, Nothing}         #Pre-optimization result object
        optim::Optim.MultivariateOptimizationResults                            #Optimization result object
    end</code></pre><p>Replicate bioequivalence structure.</p></div></div></section><h3><a class="nav-anchor" id="ReplicateBE.rbe-1" href="#ReplicateBE.rbe-1">ReplicateBE.rbe</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ReplicateBE.rbe" href="#ReplicateBE.rbe"><code>ReplicateBE.rbe</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">rbe(df; dvar::Symbol,
    subject::Symbol,
    formulation::Symbol,
    period::Symbol,
    sequence::Symbol,
    g_tol::Float64 = 1e-8, x_tol::Float64 = 0.0, f_tol::Float64 = 0.0, iterations::Int = 100,
    store_trace = false, extended_trace = false, show_trace = false,
    memopt = true)</code></pre><p>Mixed model fitting function for replicate bioequivalence without data preparation (apply categorical! for each factor and sort! to dataframe).</p><p>Mixed model in matrix form:</p><div>\[y = X\beta+Zu+\epsilon\]</div><p>math</p><p>with covariance matrix for each subject:</p><div>\[V_{i} = Z_{i}GZ_i&#39;+R_{i}\]</div></div></div></section><h3><a class="nav-anchor" id="ReplicateBE.rbe-2" href="#ReplicateBE.rbe-2">ReplicateBE.rbe</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ReplicateBE.rbe!" href="#ReplicateBE.rbe!"><code>ReplicateBE.rbe!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>This function apply following code for each factor before executing:</p><pre><code class="language-julia">    categorical!(df, subject);
    categorical!(df, formulation);
    categorical!(df, period);
    categorical!(df, sequence);
    sort!(df, [subject, formulation, period])</code></pre><p>It can takes more time, but can help to avoid some errors like: &quot;ERROR: type ContinuousTerm has no field contrasts&quot;.</p></div></div></section><h3><a class="nav-anchor" id="StatsBase.coef-1" href="#StatsBase.coef-1">StatsBase.coef</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="StatsBase.coef" href="#StatsBase.coef"><code>StatsBase.coef</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">coef(rbe::RBE)</code></pre><p>Return model coefficients.</p><div>\[\beta = {(\sum_{i=1}^n X_{i}&#39;V_i^{-1}X_{i})}^{-1}(\sum_{i=1}^n X_{i}&#39;V_i^{-1}y_{i})\]</div></div></div></section><h3><a class="nav-anchor" id="StatsBase.confint-1" href="#StatsBase.confint-1">StatsBase.confint</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="StatsBase.confint" href="#StatsBase.confint"><code>StatsBase.confint</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">confint(obj::RBE; level::Real=0.95, expci::Bool = false, inv::Bool = false, df = :sat)</code></pre><p>Compute confidence intervals for coefficients, with confidence level <code>level</code> (by default 95%).</p><p><strong>Arguments</strong></p><p><code>expci = true</code>: return exponented CI.</p><p><code>inv = true</code>: return <code>-estimate ± t*se</code></p><p><code>df = :sat</code>: use Satterthwaite DF approximation.</p><p><code>df = :df3</code> or <code>df = :cont</code>: DF (contain) = N - rank(ZX).</p><div>\[CI = stimate ± t(alpha, df)*se\]</div></div></div></section><h3><a class="nav-anchor" id="StatsBase.dof-1" href="#StatsBase.dof-1">StatsBase.dof</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="StatsBase.dof" href="#StatsBase.dof"><code>StatsBase.dof</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">dof(rbe::RBE)</code></pre><p>Return the number of degrees of freedom for the coefficients of the model.</p></div></div></section><h3><a class="nav-anchor" id="StatsBase.stderror-1" href="#StatsBase.stderror-1">StatsBase.stderror</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="StatsBase.stderror" href="#StatsBase.stderror"><code>StatsBase.stderror</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">StatsBase.stderror(rbe::RBE)</code></pre><p>Return the standard errors for the coefficients of the model.</p><div>\[se = \sqrt{LCL&#39;}\]</div></div></div></section><h3><a class="nav-anchor" id="ReplicateBE.coefnum-1" href="#ReplicateBE.coefnum-1">ReplicateBE.coefnum</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ReplicateBE.coefnum" href="#ReplicateBE.coefnum"><code>ReplicateBE.coefnum</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">coefnum(rbe::RBE)</code></pre><p>Return number of coefficients (length β).</p></div></div></section><h3><a class="nav-anchor" id="ReplicateBE.contrast-1" href="#ReplicateBE.contrast-1">ReplicateBE.contrast</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ReplicateBE.contrast" href="#ReplicateBE.contrast"><code>ReplicateBE.contrast</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">contrast(rbe::RBE, L::Matrix; numdf = 1, name = &quot;Contrast&quot;, memopt = true)::ContrastTable</code></pre><p>Return contrast table for L matrix.</p><div>\[F = \frac{\beta&#39;L&#39;(LCL&#39;)^{-1}L\beta}{rank(LCL&#39;)}\]</div><p>DF for one-dimetion case:</p><div>\[df = \frac{2(LCL&#39;)^{2}}{g&#39;Ag}\]</div><p>where <span>$A = 2H$</span></p><p>where <span>$g = \triangledown _{\theta}(LC^{-1}L&#39;)$</span></p><p>DF for multi-dimention case:</p></div></div></section><h3><a class="nav-anchor" id="ReplicateBE.design-1" href="#ReplicateBE.design-1">ReplicateBE.design</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ReplicateBE.design" href="#ReplicateBE.design"><code>ReplicateBE.design</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">design(rbe::RBE)::Design</code></pre><p>Return design information object, where:</p><pre><code class="language-julia">    struct Design
        obs::Int          # Number of observations
        subj::Int         # Number of statistica independent subjects
        sqn::Int          # Number of sequences
        pn::Int           # Number of periods
        fn::Int           # Number of formulations
        sbf::Vector{Int}  # Subjects in each formulation level
        rankx::Int        # Rank of fixed effect matrix
        rankxz::Int       # Rank of XZ (fixed+random) effect matrix
        df2::Int          # subj - sqn         (Robust DF)
        df3::Int          # obs  - rankxz      (Contain DF for sequence and period)
        df4::Int          # obs  - rankxz + p
    end</code></pre></div></div></section><h3><a class="nav-anchor" id="ReplicateBE.estimate-1" href="#ReplicateBE.estimate-1">ReplicateBE.estimate</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ReplicateBE.estimate" href="#ReplicateBE.estimate"><code>ReplicateBE.estimate</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">estimate(rbe::RBE, L::Matrix; df = :sat, name = &quot;Estimate&quot;, memopt = true, alpha = 0.05)</code></pre><p>Return estimate table for L 1xp matrix.</p><div>\[estimate = L\beta\]</div><div>\[se = \sqrt{LCL&#39;}\]</div><div>\[t = estimate/se\]</div><p>For <code>df = :sat</code>:</p><div>\[df = \frac{2(LCL&#39;)^{2}}{g&#39;Ag}\]</div><p>where <span>$A = 2H$</span></p><p>where <span>$g = \triangledown _{\theta}(LC^{-1}L&#39;)$</span></p><p>For <code>df = :cont</code> (contain):</p><div>\[df = N - rank(ZX)\]</div><p>CI estimate is:</p><div>\[CI = stimate ± t(alpha, df)*se \]</div></div></div></section><h3><a class="nav-anchor" id="ReplicateBE.fixed-1" href="#ReplicateBE.fixed-1">ReplicateBE.fixed</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ReplicateBE.fixed" href="#ReplicateBE.fixed"><code>ReplicateBE.fixed</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">fixed(rbe::RBE)</code></pre><p>Return fixed effect table (β).</p></div></div></section><h3><a class="nav-anchor" id="ReplicateBE.randrbeds-1" href="#ReplicateBE.randrbeds-1">ReplicateBE.randrbeds</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ReplicateBE.randrbeds" href="#ReplicateBE.randrbeds"><code>ReplicateBE.randrbeds</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">    randrbeds(;n=24, sequence=[1,1],
        design = [&quot;T&quot; &quot;R&quot; &quot;T&quot; &quot;R&quot;; &quot;R&quot; &quot;T&quot; &quot;R&quot; &quot;T&quot;],
        inter=[0.5, 0.4, 0.9], intra=[0.1, 0.2],
        intercept = 0, seqcoef = [0.0, 0.0], periodcoef = [0.0, 0.0, 0.0, 0.0], formcoef = [0.0, 0.0],
        dropsubj = 0.0, dropobs::Int = 0, seed::Int = 0)</code></pre><p>Random dataset generation for bioequivalence.</p><p><strong>Parameters</strong></p><pre><code class="language-none">* n: number of subjects
* sequence: distribution in sequences [1,1] means 1:1, [1,3] - 1:4 etc.
* design: desin matrix, each line is a sequence, each column - periods, cell - formulation id
* inter: inter-subject variance vector for G matrix (length 3)
* intra: intra-subject variance vector for R matrix (length 2)
* intercept: intercept effect value
* seqcoef: coefficients of sequences (length(sequence) == length(seqcoef) == size(design, 1))
* periodcoef: coefficients of periods (length(periodcoef) == size(design, 2))
* formcoef: coeficients of formulations
* dropobs: number of randomly dropped subjects
* seed: seed for random</code></pre><p>Multivariate normal disribution:</p><div>\[f(\mathbf{x}; \boldsymbol{\mu}, \boldsymbol{V}) = \frac{1}{(2 \pi)^{d/2} |\boldsymbol{V}|^{1/2}}
\exp \left( - \frac{1}{2} (\mathbf{x} - \boldsymbol{\mu})^T V^{-1} (\mathbf{x} - \boldsymbol{\mu}) \right)\]</div><p>Where V:</p><div>\[V_{i} = Z_{i}GZ_i&#39;+R_{i}\]</div></div></div><div><div><pre><code class="language-julia">    randrbeds(n::Int, sequence::Vector,
        design::Matrix,
        θinter::Vector, θintra::Vector,
        intercept::Real, seqcoef::Vector, periodcoef::Vector, formcoef::Vector,
        dropsubj::Float64, dropobs::Int, seed::Int)</code></pre><p>Simple interface.</p></div></div></section><h3><a class="nav-anchor" id="ReplicateBE.reml2-1" href="#ReplicateBE.reml2-1">ReplicateBE.reml2</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ReplicateBE.reml2" href="#ReplicateBE.reml2"><code>ReplicateBE.reml2</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">reml2(rbe::RBE, θ::Array{Float64, 1})</code></pre><p>Returm -2REML for rbe model</p></div></div><div><div><pre><code class="language-none">reml2(rbe::RBE)</code></pre><p>Returm -2logREML for rbe model</p><div>\[
logREML(\theta,\beta) = -\frac{N-p}{2} - \frac{1}{2}\sum_{i=1}^nlog|V_{i}|-

-\frac{1}{2}log|\sum_{i=1}^nX_i&#39;V_i^{-1}X_i|-\frac{1}{2}\sum_{i=1}^n(y_i - X_{i}\beta)&#39;V_i^{-1}(y_i - X_{i}\beta)\]</div></div></div></section><h3><a class="nav-anchor" id="ReplicateBE.typeiii-1" href="#ReplicateBE.typeiii-1">ReplicateBE.typeiii</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ReplicateBE.typeiii" href="#ReplicateBE.typeiii"><code>ReplicateBE.typeiii</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">typeiii(rbe::RBE)</code></pre><p>Return TYPE III table.</p><p>see contrast</p></div></div></section><footer><hr/><a class="previous" href="../struct/"><span class="direction">Previous</span><span class="title">Structures</span></a></footer></article></body></html>
