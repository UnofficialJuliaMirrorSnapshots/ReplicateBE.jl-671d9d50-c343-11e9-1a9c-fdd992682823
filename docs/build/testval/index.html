<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Validation · ReplicateBE</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>ReplicateBE</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../examples/">Examples</a></li><li><a class="toctext" href="../syntax/">Syntax</a></li><li><a class="toctext" href="../details/">Details</a></li><li class="current"><a class="toctext" href>Validation</a><ul class="internal"><li><a class="toctext" href="#Validation-1">Validation</a></li></ul></li><li><a class="toctext" href="../struct/">Structures</a></li><li><a class="toctext" href="../api/">Api</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Validation</a></li></ul><a class="edit-page" href="https://github.com/PharmCat/ReplicateBE.jl/blob/master/docs/src/testval.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Validation</span><a class="fa fa-bars" href="#"></a></div></header><h2><a class="nav-anchor" id="Validation-1" href="#Validation-1">Validation</a></h2><p>Validation program include public datasets and generated datasets. All public datasets include in test/testdata.jl.</p><p>Generated datasets made with <em>randrbeds</em> function with fixed seed (could be reproduced at any time) and include following disignes:</p><h3><a class="nav-anchor" id="subjects,-balanced-1" href="#subjects,-balanced-1">24 subjects, balanced</a></h3><ul><li>1  TRTR/RTRT</li><li>2  TRRT/RTTR</li><li>3  TTRR/RRTT</li><li>4  TRTR/RTRT/TRRT/RTTR</li><li>5  TRRT/RTTR/TTRR/RRTT</li><li>6  TRTR/RTRT/TTRR/RRTT</li><li>7  TRT/RTR</li><li>8  TRR/RTT</li><li>9  TR/RT/TT/RR</li><li>10 TRR/RTR/RRT</li><li>11 TRR/RTR*</li></ul><h3><a class="nav-anchor" id="subjects,-unbalanced,-20-dropped-observations-1" href="#subjects,-unbalanced,-20-dropped-observations-1">48 subjects, unbalanced, 20 dropped observations</a></h3><ul><li>12  TRTR/RTRT</li><li>13  TRRT/RTTR</li><li>14  TTRR/RRTT</li><li>15  TRTR/RTRT/TRRT/RTTR</li><li>16  TRRT/RTTR/TTRR/RRTT</li><li>17  TRTR/RTRT/TTRR/RRTT</li><li>18  TRT/RTR</li><li>19  TRR/RTT</li><li>20  TR/RT/TT/RR</li><li>21 TRR/RTR/RRT</li><li>22 TRR/RTR</li></ul><h3><a class="nav-anchor" id="Special-cases-1" href="#Special-cases-1">Special cases</a></h3><pre><code class="language-none">* 101 SP1: TRTR/RTRT 1024 subjects, 2000 dropped observations
* 102 SP2: TRT/RTR 4096 subjects, 2000 dropped observations (total 10288 observations)</code></pre><p>SP1 output:</p><pre><code class="language-none">rds = ReplicateBE.randrbeds(;n=1024, sequence=[1,2], design = [&quot;T&quot; &quot;R&quot; &quot;T&quot; &quot;R&quot;; &quot;R&quot; &quot;T&quot; &quot;R&quot; &quot;T&quot;], inter=[0.5, 0.4, 0.9], intra=[0.1, 0.2], intercept = 1.0, seqcoef = [0.0, 0.0], periodcoef = [0.0, 0.0, 0.0, 0.0], formcoef = [0.0, 0.1], dropobs = 2000, seed = 10101)
@time be = ReplicateBE.rbe(rds, dvar = :var, subject = :subject, formulation = :formulation, period = :period, sequence = :sequence)
  6.107196 seconds (14.51 M allocations: 981.933 MiB, 8.28% gc time)
Bioequivalence Linear Mixed Effect Model (status: converged)

-2REML: 4032.92    REML: -2016.46

Fixed effect:
─────────────────────────────────────────────────────────────────────────────────────────────
Effect           Value         SE          F           DF        t           P|t|
─────────────────────────────────────────────────────────────────────────────────────────────
(Intercept)      1.17091       0.0342916   1165.94     1215.96   34.1458     9.58974e-180*
sequence: TRTR   -0.0230415    0.0497151   0.214805    976.825   -0.463471   0.64313
period: 2        -0.0118358    0.0300503   0.15513     1397.78   -0.393865   0.69374
period: 3        -0.00522645   0.0288399   0.0328418   1139.11   -0.181223   0.856225
period: 4        -0.0271755    0.0300382   0.81848     1398.08   -0.904699   0.365781
formulation: T   -0.102651     0.0231198   19.7131     1445.78   -4.43995    9.68179e-6*
─────────────────────────────────────────────────────────────────────────────────────────────
Intra-individual variation:
formulation: R   0.202459
formulation: T   0.105328

Inter-individual variation:
formulation: R   0.396337
formulation: T   0.52727
ρ:               0.933991   Cov: 0.426964

Confidence intervals(90%):
formulation: R / formulation: T
86.8747 - 93.7445 (%)
formulation: T / formulation: R
106.673 - 115.1083 (%)</code></pre><p>SP1 output:    </p><pre><code class="language-none">rds = ReplicateBE.randrbeds(;n=4096, sequence=[1,4], design = [&quot;T&quot; &quot;R&quot; &quot;T&quot;; &quot;R&quot; &quot;T&quot; &quot;R&quot;], inter=[0.5, 0.4, 0.9], intra=[0.1, 0.9], intercept = 1.0, seqcoef = [10.0, 0.0], periodcoef = [0.0, 0.0, 0.0], formcoef = [0.0, 1.0], dropobs = 2000, seed = 10102)
be = ReplicateBE.rbe(rds, dvar = :var, subject = :subject, formulation = :formulation, period = :period, sequence = :sequence)
312.655087 seconds (269.38 M allocations: 14.273 GiB, 1.47% gc time)
Bioequivalence Linear Mixed Effect Model (status: converged)

-2REML: 26633.2    REML: -13316.6

Fixed effect:
───────────────────────────────────────────────────────────────────────────────────────
Effect           Value         SE          F          DF        t           P|t|
───────────────────────────────────────────────────────────────────────────────────────
(Intercept)      1.99206       0.0184652   11638.4    4779.03   107.882     0.0*
sequence: TRT    10.0134       0.0322104   96643.1    5028.62   310.875     0.0*
period: 2        0.0193164     0.0223827   0.744777   6811.0    0.863005    0.388165
period: 3        -0.00501682   0.0152331   0.108463   1577.27   -0.329338   0.741944
formulation: T   -0.995365     0.0210042   2245.71    6298.6    -47.3889    0.0*
Intra-individual variation:
formulation: R   0.885914
formulation: T   0.106905

Inter-individual variation:
formulation: R   0.380248
formulation: T   0.491359
ρ:               0.902941   Cov: 0.390294

Confidence intervals(90%):
formulation: R / formulation: T
35.7036 - 38.2583 (%)
formulation: T / formulation: R
261.3815 - 280.0838 (%)</code></pre><p>SAS procedures for generated datasets can be found in <a href="https://github.com/PharmCat/ReplicateBE.jl/tree/master/validation/sas"><em>validation/sas/</em></a> folder.</p><p>All validation datasets (except special - SPX) include in package test procedure.</p><p><em>SAS WARNING</em>: Stopped because of infinite likelihood.</p><h3><a class="nav-anchor" id="Simulation-study-1" href="#Simulation-study-1">Simulation study</a></h3><p>Following simulation was performed for version v0.1.4:</p><pre><code class="language-none">  using Distributions, ReplicateBE
  function simulation(num)
    n   = 0
    err = 0
    cnt = 0
    b = l = log(0.8)
    u = log(1.25)
    println(&quot;Start...&quot;)
    for i = 1:num
        try
            rds   = ReplicateBE.randrbeds(;n=24, sequence=[1,1], design = [&quot;T&quot; &quot;R&quot; &quot;T&quot; &quot;R&quot;; &quot;R&quot; &quot;T&quot; &quot;R&quot; &quot;T&quot;], inter=[0.2, 0.2, 0.5], intra=[0.05, 0.05], intercept = 1.0, seqcoef = [0.0, 0.0], periodcoef = [0.0, 0.0, 0.0, 0.0], formcoef = [b, 0.0])
            be    = ReplicateBE.rbe(rds, dvar = :var, subject = :subject, formulation = :formulation, period = :period, sequence = :sequence, memopt = false)
            q     = quantile(TDist(be.fixed.df[6]), 0.95)
            ll    = be.fixed.est[6] - q*be.fixed.se[6]
            ul    = be.fixed.est[6] + q*be.fixed.se[6]
            if ll &gt; l &amp;&amp; ul &lt; u cnt += 1 end
            if n &gt; 1000
                println(&quot;Iteration: $i&quot;)
                println(&quot;Mem: $(Sys.free_memory()/2^20)&quot;)
                println(&quot;Pow: $(cnt/i)&quot;)
                println(&quot;-------------------------------&quot;)
                n = 0
            end
            n += 1
        catch
            err += 1
            println(&quot;Error $(err)!&quot;)
        end
    end
    return cnt/num
end

simulation(100000)</code></pre><p>Rusults:</p><pre><code class="language-none"> 7104.944474 seconds (9.51 G allocations: 2.230 TiB, 44.90% gc time)
0.04939</code></pre><p>Cofinence interval (95%) for power: 0.048047 - 0.050733. No statistically significant difference found.</p><footer><hr/><a class="previous" href="../details/"><span class="direction">Previous</span><span class="title">Details</span></a><a class="next" href="../struct/"><span class="direction">Next</span><span class="title">Structures</span></a></footer></article></body></html>
